---
발표자: 김건
발표일: 2023-11-19
---

# 01. 신뢰할 수 있고 확장 가능하며 유지보수하기 쉬운 애플리케이션

오늘날 많은 애플리케이션은 계산 중심 보단 데이터 중심적이다.

- **데이터 중심 애플리케이션**에서는 CPU 성능보다 데이터의 양, 데이터의 복잡도, 데이터의 변화 속도 등이 주로 제한 요소이다.

## 데이터 시스템에 대한 생각

DB, Queue, Cache 등 데이터를 다루는 여러 도구들이 있지만, 데이터에 대한 접근 방법과 구현 방식이 매우 다르기 때문에 다른 범주에 속하는 도구로 생각함.

서로 다른 성격의 도구들을 **데이터 시스템**이라는 포괄적 용어로 묶어야 하는 이유는?

1. 기술이 발전함에 따라 도구들의 분류에 대한 경계가 무너져 명확히 구분이 어려워지는 경우가 생김.
2. 요구사항이 광범위해지면서 단일 도구로는 해당 요구사항들을 모두 충족시킬 수 없음.
    1. 즉, 여러 도구들을 결합해서 사용해야 함. (이 때 클라이언트는 어떤 기술을 쓰는지 알 수 없게 추상화되어 있음)

## 신뢰성

- 애플리케이션이 사용자의 기대에 맞는 기능을 수행한다.
- 사용자 실수나 예상치 못한 사용을 수용하며, 필요한 경우에 적절한 성능을 제공하고, 무단 접근과 오남용을 방지한다.

핵심 요소 중 하나는 **내결함성**(또는 탄력성, 시스템이 결함에 대처할 수 있는 능력)이다.

모든 결함을 예방하는 것은 불가능하므로, 주로 시스템이 결함으로 인한 장애로 이어지지 않도록 설계하는 것이 중요하다.

**결함**과 **장애**는 서로 다른 개념이다.

**결함**은 시스템의 한 구성 요소에서 발생하는 문제를 가리키는 반면,
**장애**는 시스템 전체가 멈추는 상황을 의미한다.

---

예를 들어, Netflix의 '카오스 몽키'와 같은 도구들은 고의적으로 **결함을 유발**하여 시스템의 내결함성을 강화한다.

- 고의적으로 결함을 일으켜서 결함이 잘 처리되는지에 대해 테스트해보는 것

보안 문제와 같이 **예방**이 **해결책**보다 중요한 경우도 있다. 예방이 가능한 경우에는 해결책을 찾기보다 사전에 문제를 방지하는 것이 더 좋을 수 있다.

### 하드웨어 결함

말 그대로 하드웨어에 문제가 생기는 것, 정전이 나거나 케이블이 뽑히거나 장비에 이상이 생기는 등.

- 시스템 장애율을 감소 시키기 위해 하드웨어의 예비를 통한 가용성 증진하여 대응할 수 있다.

### 소프트웨어 오류

말 그대로 소프트웨어 오류.

- 실제 발생할 때까지 예측하기 어려우며, 커널 문제처럼 시멘틱한 오류라면 신속한 해결책도 없다.

### 인적 오류

사람의 문제.

- 오류를 시스템적으로 방지하도록 설계하고, 철저히 테스트하고, 복구 및 모니터링 대책을 마련한다.

## 신뢰성은 얼마나 중요한지?

사소한 일반적인 애플리케이션들도 안정적으로 작동해야 한다.

- 비용 감소를 위해 신뢰성을 희생할 순 있다. 하지만 줄여야 하는 시점을 잘 알아야 한다.
-

## 확장성

현재 잘 동작한다고 해서 미래에도 안정적으로 동작한다는 보장은 없다.
주로 성능 저하의 흔한 이유는 부하 증가이다.

- 1명이 사용하다가 갑자기 100만명이 이용한다면 어떻게 될까?

확장성을 논한다는 것은

1. 시스템이 특정 방식으로 커지면 대처하기 위한 선택은?
2. 추가 부하를 다루기 위해 계산 자원을 어떻게 투입할지?

등을 고려한다는 의미다.

### 부하 기술하기

현재 시스템 부하를 간결하게 기술하는 것이 중요함.

- 현재의 시스템 부하를 알아야 몇배의 트래픽이 늘어났을 경우에 대한 대책 논의가 가능함.

부하는 **부하 매개변수**라고 부르는 몇가지 숫자로 나타낼 수 있음.

1. 웹 서버의 초당 요청 수: **Requests Per Second (RPS)**
2. 데이터베이스의 읽기 대 쓰기 비율: **Read-to-Write Ratio**
3. 대화방의 동시 활성 사용자: **Concurrent Active Users**
4. 캐시 적중률: **Cache Hit Rate**

매개변수 수치를 통해 현재 시스템이 얼마나 버틸 수 있는지 예측이 가능하다.

### 성능 기술하기

부하 기술이 되었다면 부하가 증가됐을 때 어떤 일이 일어날지 예측이 가능하다.

- 부하가 증가했을 때 어떤 영향을 받을지?
- 부하가 증가했을 때 성능이 유지되려면 시스템 자원을 얼마나 늘려야 할지?

보통 두가지 유형의 시스템 유형이 존재한다.

- 온라인 시스템(OLTP)에서는**`응답 시간(response time)`**이 더 중요하다.
- 일괄 처리 시스템(Batch)에서는**`처리량(throughput)`**이 더 중요하다.

시스템 유형에 따라 중요하게 봐야하는 수치가 다를 수 있음을 의미한다.

### 부하 대응 접근 방식

부하가 증가하더라도 좋은 성능을 유지하려면 어떤 방식으로 대응할 수 있을까?

- 장비의 성능을 업그레이드 하는 ⇒ 스케일 업(Scale Up)
- 장비의 대수를 늘려서 부하를 분산하는 ⇒ 스케일 아웃 (Scale Out, 비공유 아키텍처라고도 부름)

클라우드와 같은 시스템은 탄력적이라 부하 증가 시 컴퓨팅 자원을 자동 추가할 수 있다.  
일반 시스템(온프레미스)에서는 수동으로 사람이 직접 확장해야 한다. ⇒ 실수 가능성(인적 오류)

스케일 아웃을 할 때 state-less 서비스는 간단하다.

- 상태를 가지고 있지 않기 때문에 장비만 추가해버리면 끝이다.

stateful하다면 상태를 어떻게 동기화할지와 같은 복잡도가 추가로 발생하여 쉽지 않다.

- 예를 들어, 데이터베이스를 스케일 아웃하려면 데이터를 어떻게 분산할지, 어떻게 동기화할지 등을 고려해야 한다.
- 이런 이유로 state-less 서비스가 확장이 쉽다.

---

대개 대규모로 동작하는 시스템 아키텍처는 특정 상황에 특화돼있다. 고로 상황에 맞는 아키텍처를 선택하는 것이 중요하다.

주요 동작과 비주요 동작에 대한 가정이 곧 부하 매개변수가 되므로 이 가정을 바탕으로 아키텍처를 구축할 필요가 있다.
- 초기에는 검증되지 않은 제품의 미래를 가정해서 확장하기 보다 빠르게 반복해서 개선하는 것이 좀 더 중요할 **수도** 있다.

## 유지보수성

말 그대로 유지보수하기 좋은 것을 의미. 3가지 원칙에 주의를 기울이자.

- 운용성 - 운영팀이 사용하기 쉽게 만들기
- 단순성 - 단순하게 새로운 엔지니어가 이해하기 쉽게 만들기
- 발전성 - 시스템을 쉽게 변경할 수 있게 만들기

## 운용성: 운영의 편리함 만들기

좋은 소프트웨어라도 나쁘게 운영할 경우 작동을 신뢰할 수 없을 수 있다.

운영의 작업을 자동화하는 것이 중요하다.

- 왜냐면 사람이 수동으로 한다는 것은 인적 오류의 가능성이 있음. 자동화한다면 이것을 방지 가능.

시스템이 원활하려면 운영팀이 필수. (운영팀 땡큐..)

운영팀의 저부가가치(노가다 작업들) 작업들을 쉽게 수행 및 자동화해서 운영팀이 고부가가치 활동에 집중할 수 있도록 도와야 한다.

## 단순성: 복잡도 관리

프로젝트가 커지면서 시스템은 복잡하고 이해하기 어려워진다. 즉, 유지보수 비용 증가
- 이 문제를 커다란 진흙 덩어리(big ball of mud)라고도 부른다.

복잡도는 여러 증상으로 나타날 수 있다.
- 모듈 간 강한 결합
  - A가 변경되면 B도 변경해야 함.
- 일관성 없는 네이밍
    - human → person
- 복잡한 의존성
  - A → B → C → D → A

복잡도 때문에 유지보수가 어려우면 결국 예산과 일정을 초과하며 버그의 여지가 큼. 단순성을 핵심 목표로 잡아야 함.

단순하다는건 기능을 줄이는 걸 의미하진 않음. (우발적 복잡도)를 줄인다는 뜻일 수도..

- 우발적 복잡도를 제거하기의 최상의 도구는 추상화임.

## 발전성: 변화를 쉽게 만들기

요구사항은 끊임없이 변할 가능성이 큼.

변경을 쉽게 하고 변화된 요구사항에 시스템을 맞추는 방법은 시스템의 간단함과 추
상화와 밀접한 관련이 있다.